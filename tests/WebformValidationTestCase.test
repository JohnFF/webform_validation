<?php

/**
 * @file
 * Test Webform Validation module.
 */
class WebformValidationTestCase extends WebformTestCase {
  /**
   * {@inheritdoc}
   */
  public static function getInfo() {
    return array(
      'name' => t('Webform Validation'),
      'description' => t('Test Webform Validation module.'),
      'group' => t('Webform'),
    );
  }

  /**
   * {@inheritdoc}
   */
  function setUp($added_modules = array()) {
    $modules = array('webform_validation');
    parent::setUp(array_merge($modules, $added_modules));
  }

  function test() {
    // Test access to "Form validation" tab.
    $node = $this->webformForm();

    $this->drupalLogin($this->webform_users['userAccess']);
    $this->drupalGet('node/' . $node->nid . '/webform/validation');
    $this->assertResponse(403, 'Authenticated user does not have access to "Form validation" tab');

    $this->drupalLogin($this->webform_users['admin']);
    $this->drupalGet('node/' . $node->nid . '/webform/validation');
    $this->assertResponse(200, 'Webform admin user has access to "Form validation" tab');
    $this->assertText('Add a validation rule');
    $this->assertText('No validation rules available.');
  }
}
